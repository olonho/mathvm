1. typechecker for IR + casts
2. substitutions (constants, other variables) + precalculations
3. inline small functions